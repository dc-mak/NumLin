% generated by Ott 0.25 from: semantics.ott
\newcommand{\ottdrule}[4][]{{\displaystyle\frac{\begin{array}{l}#2\end{array}}{#3}\quad\ottdrulename{#4}}}
\newcommand{\ottusedrule}[1]{\[#1\]}
\newcommand{\ottpremise}[1]{ #1 \\}
\newenvironment{ottdefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]}{}
\newenvironment{ottfundefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]\begin{displaymath}\begin{array}{l}}{\end{array}\end{displaymath}}
\newcommand{\ottfunclause}[2]{ #1 \equiv #2 \\}
\newcommand{\ottnt}[1]{\mathit{#1}}
\newcommand{\ottmv}[1]{\mathit{#1}}
\newcommand{\ottkw}[1]{\mathbf{#1}}
\newcommand{\ottsym}[1]{#1}
\newcommand{\ottcom}[1]{\text{#1}}
\newcommand{\ottdrulename}[1]{\textsc{#1}}
\newcommand{\ottcomplu}[5]{\overline{#1}^{\,#2\in #3 #4 #5}}
\newcommand{\ottcompu}[3]{\overline{#1}^{\,#2<#3}}
\newcommand{\ottcomp}[2]{\overline{#1}^{\,#2}}
\newcommand{\ottgrammartabular}[1]{\begin{supertabular}{llcllllll}#1\end{supertabular}}
\newcommand{\ottmetavartabular}[1]{\begin{supertabular}{ll}#1\end{supertabular}}
\newcommand{\ottrulehead}[3]{$#1$ & & $#2$ & & & \multicolumn{2}{l}{#3}}
\newcommand{\ottprodline}[6]{& & $#1$ & $#2$ & $#3 #4$ & $#5$ & $#6$}
\newcommand{\ottfirstprodline}[6]{\ottprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\ottlongprodline}[2]{& & $#1$ & \multicolumn{4}{l}{$#2$}}
\newcommand{\ottfirstlongprodline}[2]{\ottlongprodline{#1}{#2}}
\newcommand{\ottbindspecprodline}[6]{\ottprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\ottprodnewline}{\\}
\newcommand{\ottinterrule}{\\[5.0mm]}
\newcommand{\ottafterlastrule}{\\}
\newcommand{\ottmetavars}{
\ottmetavartabular{
 $ \mathit{fc} $ & \ottcom{fractional capability variable} \\
 $ \mathit{x} ,\, \mathit{g} ,\, \mathit{a} ,\, \mathit{b} $ & \ottcom{expression variable} \\
 $ \mathit{k} $ & \ottcom{integer variable} \\
 $ \mathit{el} $ & \ottcom{array-element variable} \\
}}

\newcommand{\ottterminals}{
\ottrulehead{symb}{::=}{}\ottprodnewline
\ottfirstprodline{|}{ \lambda }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \otimes }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \multimap }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \vdash }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \in }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \forall }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \textsf{Cap} }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \textsf{Type} }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \: ! }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \rightarrow }{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{value}}{}{}{}{}}

\newcommand{\ottf}{
\ottrulehead{\ottnt{f}}{::=}{\ottcom{fractional capability}}\ottprodnewline
\ottfirstprodline{|}{\mathit{fc}}{}{}{}{\ottcom{variable}}\ottprodnewline
\ottprodline{|}{\ottkw{Z}}{}{}{}{\ottcom{zero}}\ottprodnewline
\ottprodline{|}{\ottkw{S} \, \ottnt{f}}{}{}{}{\ottcom{successor}}}

\newcommand{\ottt}{
\ottrulehead{\ottnt{t}}{::=}{\ottcom{linear type}}\ottprodnewline
\ottfirstprodline{|}{\ottkw{unit}}{}{}{}{\ottcom{unit}}\ottprodnewline
\ottprodline{|}{\ottkw{bool}}{}{}{}{\ottcom{boolean (true/false)}}\ottprodnewline
\ottprodline{|}{\ottkw{int}}{}{}{}{\ottcom{63-bit integers}}\ottprodnewline
\ottprodline{|}{\ottkw{elt}}{}{}{}{\ottcom{array element}}\ottprodnewline
\ottprodline{|}{\ottnt{f} \, \ottkw{arr}}{}{}{}{\ottcom{arrays}}\ottprodnewline
\ottprodline{|}{\ottnt{f} \, \ottkw{mat}}{}{}{}{\ottcom{matrices}}\ottprodnewline
\ottprodline{|}{\: !  \ottnt{t}}{}{}{}{\ottcom{multiple-use type}}\ottprodnewline
\ottprodline{|}{\forall \, \mathit{fc}  \ottsym{.}  \ottnt{t}}{}{\textsf{bind}\; \mathit{fc}\; \textsf{in}\; \ottnt{t}}{}{\ottcom{frac. cap. generalisation}}\ottprodnewline
\ottprodline{|}{\ottnt{t}  \otimes  \ottnt{t'}}{}{}{}{\ottcom{pair}}\ottprodnewline
\ottprodline{|}{\ottnt{t}  \multimap  \ottnt{t'}}{}{}{}{\ottcom{linear function}}\ottprodnewline
\ottprodline{|}{\ottnt{t}  \ottsym{\{}  \ottnt{f}  \ottsym{/}  \mathit{fc}  \ottsym{\}}} {\textsf{M}}{}{}{\ottcom{substitution}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottnt{t}  \ottsym{)}} {\textsf{S}}{}{}{\ottcom{parentheses}}}

\newcommand{\otte}{
\ottrulehead{\ottnt{e}}{::=}{\ottcom{expression}}\ottprodnewline
\ottfirstprodline{|}{\ottnt{p}}{}{}{}{\ottcom{primitives (arithmetic, L1 BLAS, Owl)}}\ottprodnewline
\ottprodline{|}{\mathit{x}}{}{}{}{\ottcom{variable}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{)}}{}{}{}{\ottcom{unit introduction}}\ottprodnewline
\ottprodline{|}{\ottkw{true}}{}{}{}{\ottcom{true (boolean introduction)}}\ottprodnewline
\ottprodline{|}{\ottkw{false}}{}{}{}{\ottcom{false (boolean introduction)}}\ottprodnewline
\ottprodline{|}{\ottkw{if} \, \ottnt{e} \, \ottkw{then} \, \ottnt{e_{{\mathrm{1}}}} \, \ottkw{else} \, \ottnt{e_{{\mathrm{2}}}}}{}{}{}{\ottcom{if (boolean elimination)}}\ottprodnewline
\ottprodline{|}{\mathit{k}}{}{}{}{\ottcom{integer}}\ottprodnewline
\ottprodline{|}{\mathit{el}}{}{}{}{\ottcom{array element}}\ottprodnewline
\ottprodline{|}{\ottkw{many} \, \ottnt{e}}{}{}{}{\ottcom{packing-up a non-linear value}}\ottprodnewline
\ottprodline{|}{\ottkw{let} \, \ottkw{many} \, \mathit{x}  \ottsym{=}  \ottnt{e} \, \ottkw{in} \, \ottnt{e'}}{}{}{}{\ottcom{using a non-linear value}}\ottprodnewline
\ottprodline{|}{\ottkw{fun} \, \mathit{fc}  \rightarrow  \ottnt{e}}{}{}{}{\ottcom{frac. cap. abstraction}}\ottprodnewline
\ottprodline{|}{\ottnt{e}  \ottsym{[}  \ottnt{f}  \ottsym{]}}{}{}{}{\ottcom{frac. cap. specialisation}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottnt{e}  \ottsym{,}  \ottnt{e'}  \ottsym{)}}{}{}{}{\ottcom{pair introduction}}\ottprodnewline
\ottprodline{|}{\ottkw{let} \, \ottsym{(}  \mathit{a}  \ottsym{,}  \mathit{b}  \ottsym{)}  \ottsym{=}  \ottnt{e} \, \ottkw{in} \, \ottnt{e'}}{}{\textsf{bind}\; \mathit{a} \cup  \mathit{b}\; \textsf{in}\; \ottnt{e'}}{}{\ottcom{pair elimination}}\ottprodnewline
\ottprodline{|}{\ottkw{fun} \, \mathit{x}  \ottsym{:}  \ottnt{t}  \rightarrow  \ottnt{e}}{}{\textsf{bind}\; \mathit{x}\; \textsf{in}\; \ottnt{e}}{}{\ottcom{abstraction}}\ottprodnewline
\ottprodline{|}{\ottnt{e} \, \ottnt{e'}}{}{}{}{\ottcom{application}}\ottprodnewline
\ottprodline{|}{\ottkw{fix} \, \ottsym{(}  \mathit{g}  \ottsym{,}  \mathit{x}  \ottsym{:}  \ottnt{t}  \ottsym{,}  \ottnt{e}  \ottsym{:}  \ottnt{t'}  \ottsym{)}}{}{\textsf{bind}\; \mathit{g} \cup  \mathit{x}\; \textsf{in}\; \ottnt{e}}{}{\ottcom{fixpoint}}}

\newcommand{\ottp}{
\ottrulehead{\ottnt{p}}{::=}{\ottcom{primitive}}\ottprodnewline
\ottfirstprodline{|}{\ottkw{set}}{}{}{}{\ottcom{array index assignment}}\ottprodnewline
\ottprodline{|}{\ottkw{get}}{}{}{}{\ottcom{array indexing}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{+}  \ottsym{)}}{}{}{}{\ottcom{integer addition}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{-}  \ottsym{)}}{}{}{}{\ottcom{integer subtraction}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{*}  \ottsym{)}}{}{}{}{\ottcom{integer multiplication}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{/}  \ottsym{)}}{}{}{}{\ottcom{integer division}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{=}  \ottsym{)}}{}{}{}{\ottcom{integer equality}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{<}  \ottsym{)}}{}{}{}{\ottcom{integer less-than}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{+.}  \ottsym{)}}{}{}{}{\ottcom{element addition}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{-.}  \ottsym{)}}{}{}{}{\ottcom{element subtraction}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{*.}  \ottsym{)}}{}{}{}{\ottcom{element multiplication}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{/.}  \ottsym{)}}{}{}{}{\ottcom{element division}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{=.}  \ottsym{)}}{}{}{}{\ottcom{element equality}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{<.}  \ottsym{)}}{}{}{}{\ottcom{element comparsion (less-than)}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{\&\&}  \ottsym{)}}{}{}{}{\ottcom{boolean conjuction}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottsym{\mbox{$\mid$}\mbox{$\mid$}}  \ottsym{)}}{}{}{}{\ottcom{boolean disjunction}}\ottprodnewline
\ottprodline{|}{\ottkw{not}}{}{}{}{\ottcom{boolean negation}}\ottprodnewline
\ottprodline{|}{\ottkw{share}}{}{}{}{\ottcom{share array}}\ottprodnewline
\ottprodline{|}{\ottkw{unshare}}{}{}{}{\ottcom{unshare array}}\ottprodnewline
\ottprodline{|}{\ottkw{free}}{}{}{}{\ottcom{free arrary}}\ottprodnewline
\ottprodline{|}{\ottkw{array}}{}{}{}{\ottcom{Owl:  make array}}\ottprodnewline
\ottprodline{|}{\ottkw{copy}}{}{}{}{\ottcom{Owl:  copy array}}\ottprodnewline
\ottprodline{|}{\ottkw{sin}}{}{}{}{\ottcom{Owl:  sine of all elements in array}}\ottprodnewline
\ottprodline{|}{\ottkw{hypot}}{}{}{}{\ottcom{Owl:  $x_i := \sqrt{x_i^2 + y_i^2}$}}\ottprodnewline
\ottprodline{|}{\ottkw{asum}}{}{}{}{\ottcom{BLAS: $\sum_i | x_i |$}}\ottprodnewline
\ottprodline{|}{\ottkw{axpy}}{}{}{}{\ottcom{BLAS: $x := \alpha x + y$}}\ottprodnewline
\ottprodline{|}{\ottkw{dot}}{}{}{}{\ottcom{BLAS: $x \cdot y$}}\ottprodnewline
\ottprodline{|}{\ottkw{rotmg}}{}{}{}{\ottcom{BLAS: gen. mod. Givens rotation}}\ottprodnewline
\ottprodline{|}{\ottkw{scal}}{}{}{}{\ottcom{BLAS: $x := \alpha x$}}\ottprodnewline
\ottprodline{|}{\ottkw{amax}}{}{}{}{\ottcom{BLAS: index of maximum absolute value}}\ottprodnewline
\ottprodline{|}{\ottkw{setM}}{}{}{}{\ottcom{matrix index assignment}}\ottprodnewline
\ottprodline{|}{\ottkw{getM}}{}{}{}{\ottcom{matrix indexing}}\ottprodnewline
\ottprodline{|}{\ottkw{shareM}}{}{}{}{\ottcom{share matrix}}\ottprodnewline
\ottprodline{|}{\ottkw{unshareM}}{}{}{}{\ottcom{unshare matrix}}\ottprodnewline
\ottprodline{|}{\ottkw{freeM}}{}{}{}{\ottcom{free matrix}}\ottprodnewline
\ottprodline{|}{\ottkw{matrix}}{}{}{}{\ottcom{Owl:  make matrix}}\ottprodnewline
\ottprodline{|}{\ottkw{copyM}}{}{}{}{\ottcom{Owl:  copy matrix}}\ottprodnewline
\ottprodline{|}{\ottkw{gemv}}{}{}{}{\ottcom{BLAS: $y := \alpha A^{T?} x + \beta y$}}\ottprodnewline
\ottprodline{|}{\ottkw{symv}}{}{}{}{\ottcom{BLAS: $y := \alpha A_\textrm{sym} x + \beta y$}}\ottprodnewline
\ottprodline{|}{\ottkw{trmv}}{}{}{}{\ottcom{BLAS: $x := A^{T?} * x$}}\ottprodnewline
\ottprodline{|}{\ottkw{trsv}}{}{}{}{\ottcom{BLAS: $x := A^{-1 \cdot T?} * x$}}\ottprodnewline
\ottprodline{|}{\ottkw{ger}}{}{}{}{\ottcom{BLAS: $A := \alpha * x * y^T + A$}}\ottprodnewline
\ottprodline{|}{\ottkw{gemm}}{}{}{}{\ottcom{BLAS: $C := \alpha * A^{T?}* B^{T?} + \beta C$}}\ottprodnewline
\ottprodline{|}{\ottkw{trmm}}{}{}{}{\ottcom{BLAS: $B := \alpha * A^{T?} * B$ and swapped}}\ottprodnewline
\ottprodline{|}{\ottkw{trsm}}{}{}{}{\ottcom{BLAS: $B := \alpha * A^{-1 \cdot T?} * B$ and swapped}}}

\newcommand{\ottT}{
\ottrulehead{\Theta}{::=}{\ottcom{fractional capability environment}}\ottprodnewline
\ottfirstprodline{|}{ \cdot }{}{}{}{}\ottprodnewline
\ottprodline{|}{\Theta  \ottsym{,}  \mathit{fc}}{}{}{}{}}

\newcommand{\ottG}{
\ottrulehead{\Gamma}{::=}{\ottcom{linear types environment}}\ottprodnewline
\ottfirstprodline{|}{ \cdot }{}{}{}{}\ottprodnewline
\ottprodline{|}{\Gamma  \ottsym{,}  \mathit{x}  \ottsym{:}  \ottnt{t}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Gamma  \ottsym{,}  \Gamma'}{}{}{}{}}

\newcommand{\ottD}{
\ottrulehead{\Delta}{::=}{\ottcom{linear types environment}}\ottprodnewline
\ottfirstprodline{|}{ \cdot }{}{}{}{}\ottprodnewline
\ottprodline{|}{\Delta  \ottsym{,}  \mathit{x}  \ottsym{:}  \ottnt{t}}{}{}{}{}}

\newcommand{\ottformula}{
\ottrulehead{\ottnt{formula}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottnt{judgement}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\mathit{x}  \ottsym{:}  \ottnt{t} \, \in \, \Delta}{}{}{}{}\ottprodnewline
\ottprodline{|}{\mathit{x}  \ottsym{:}  \ottnt{t} \, \in \, \Gamma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\mathit{fc} \, \in \, \Theta}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{value} \, \ottsym{(}  \ottnt{e}  \ottsym{)}}{}{}{}{}}

\newcommand{\ottWellXXFormed}{
\ottrulehead{\ottnt{Well\_Formed}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\Theta  \vdash  \ottnt{f} \, \textsf{Cap}}{}{}{}{\ottcom{Valid fractional capabilities}}\ottprodnewline
\ottprodline{|}{\Theta  \vdash  \ottnt{t} \, \textsf{Type}}{}{}{}{\ottcom{Valid types}}}

\newcommand{\ottValues}{
\ottrulehead{\ottnt{Values}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottkw{value} \, \ottsym{(}  \ottnt{e}  \ottsym{)}}{}{}{}{\ottcom{Value restriction for !-introduction}}}

\newcommand{\ottTypes}{
\ottrulehead{\ottnt{Types}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}}{}{}{}{\ottcom{Typing rules for expressions (no primitives yet)}}}

\newcommand{\ottjudgement}{
\ottrulehead{\ottnt{judgement}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottnt{Well\_Formed}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{Values}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{Types}}{}{}{}{}}

\newcommand{\ottuserXXsyntax}{
\ottrulehead{\ottnt{user\_syntax}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\mathit{fc}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\mathit{x}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\mathit{k}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\mathit{el}}{}{}{}{}\ottprodnewline
\ottprodline{|}{symb}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{f}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{t}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{e}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{p}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Theta}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Gamma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Delta}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{formula}}{}{}{}{}}

\newcommand{\ottgrammar}{\ottgrammartabular{
\ottterminals\ottinterrule
\ottf\ottinterrule
\ottt\ottinterrule
\otte\ottinterrule
\ottp\ottinterrule
\ottT\ottinterrule
\ottG\ottinterrule
\ottD\ottinterrule
\ottformula\ottinterrule
\ottWellXXFormed\ottinterrule
\ottValues\ottinterrule
\ottTypes\ottinterrule
\ottjudgement\ottinterrule
\ottuserXXsyntax\ottafterlastrule
}}

% defnss
% defns Well_Formed
%% defn Cap_
\newcommand{\ottdruleWFXXCapXXVar}[1]{\ottdrule[#1]{%
\ottpremise{\mathit{fc} \, \in \, \Theta}%
}{
\Theta  \vdash  \mathit{fc} \, \textsf{Cap}}{%
{\ottdrulename{WF\_Cap\_Var}}{}%
}}


\newcommand{\ottdruleWFXXCapXXZero}[1]{\ottdrule[#1]{%
}{
\Theta  \vdash  \ottkw{Z} \, \textsf{Cap}}{%
{\ottdrulename{WF\_Cap\_Zero}}{}%
}}


\newcommand{\ottdruleWFXXCapXXSucc}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \vdash  \ottnt{f} \, \textsf{Cap}}%
}{
\Theta  \vdash  \ottkw{S} \, \ottnt{f} \, \textsf{Cap}}{%
{\ottdrulename{WF\_Cap\_Succ}}{}%
}}

\newcommand{\ottdefnWFXXCapXX}[1]{\begin{ottdefnblock}[#1]{$\Theta  \vdash  \ottnt{f} \, \textsf{Cap}$}{\ottcom{Valid fractional capabilities}}
\ottusedrule{\ottdruleWFXXCapXXVar{}}
\ottusedrule{\ottdruleWFXXCapXXZero{}}
\ottusedrule{\ottdruleWFXXCapXXSucc{}}
\end{ottdefnblock}}

%% defn Type_
\newcommand{\ottdruleWFXXTypeXXUnit}[1]{\ottdrule[#1]{%
}{
\Theta  \vdash  \ottkw{unit} \, \textsf{Type}}{%
{\ottdrulename{WF\_Type\_Unit}}{}%
}}


\newcommand{\ottdruleWFXXTypeXXBool}[1]{\ottdrule[#1]{%
}{
\Theta  \vdash  \ottkw{bool} \, \textsf{Type}}{%
{\ottdrulename{WF\_Type\_Bool}}{}%
}}


\newcommand{\ottdruleWFXXTypeXXInt}[1]{\ottdrule[#1]{%
}{
\Theta  \vdash  \ottkw{int} \, \textsf{Type}}{%
{\ottdrulename{WF\_Type\_Int}}{}%
}}


\newcommand{\ottdruleWFXXTypeXXElt}[1]{\ottdrule[#1]{%
}{
\Theta  \vdash  \ottkw{elt} \, \textsf{Type}}{%
{\ottdrulename{WF\_Type\_Elt}}{}%
}}


\newcommand{\ottdruleWFXXTypeXXArray}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \vdash  \ottnt{f} \, \textsf{Cap}}%
}{
\Theta  \vdash  \ottnt{f} \, \ottkw{arr} \, \textsf{Type}}{%
{\ottdrulename{WF\_Type\_Array}}{}%
}}


\newcommand{\ottdruleWFXXTypeXXBang}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \vdash  \ottnt{t} \, \textsf{Type}}%
}{
\Theta  \vdash  \: !  \ottnt{t} \, \textsf{Type}}{%
{\ottdrulename{WF\_Type\_Bang}}{}%
}}


\newcommand{\ottdruleWFXXTypeXXGen}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \ottsym{,}  \mathit{fc}  \vdash  \ottnt{t} \, \textsf{Type}}%
}{
\Theta  \vdash  \forall \, \mathit{fc}  \ottsym{.}  \ottnt{t} \, \textsf{Type}}{%
{\ottdrulename{WF\_Type\_Gen}}{}%
}}


\newcommand{\ottdruleWFXXTypeXXPair}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \vdash  \ottnt{t} \, \textsf{Type}}%
\ottpremise{\Theta  \vdash  \ottnt{t'} \, \textsf{Type}}%
}{
\Theta  \vdash  \ottnt{t}  \otimes  \ottnt{t'} \, \textsf{Type}}{%
{\ottdrulename{WF\_Type\_Pair}}{}%
}}


\newcommand{\ottdruleWFXXTypeXXLolly}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \vdash  \ottnt{t} \, \textsf{Type}}%
\ottpremise{\Theta  \vdash  \ottnt{t'} \, \textsf{Type}}%
}{
\Theta  \vdash  \ottnt{t}  \multimap  \ottnt{t'} \, \textsf{Type}}{%
{\ottdrulename{WF\_Type\_Lolly}}{}%
}}

\newcommand{\ottdefnWFXXTypeXX}[1]{\begin{ottdefnblock}[#1]{$\Theta  \vdash  \ottnt{t} \, \textsf{Type}$}{\ottcom{Valid types}}
\ottusedrule{\ottdruleWFXXTypeXXUnit{}}
\ottusedrule{\ottdruleWFXXTypeXXBool{}}
\ottusedrule{\ottdruleWFXXTypeXXInt{}}
\ottusedrule{\ottdruleWFXXTypeXXElt{}}
\ottusedrule{\ottdruleWFXXTypeXXArray{}}
\ottusedrule{\ottdruleWFXXTypeXXBang{}}
\ottusedrule{\ottdruleWFXXTypeXXGen{}}
\ottusedrule{\ottdruleWFXXTypeXXPair{}}
\ottusedrule{\ottdruleWFXXTypeXXLolly{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsWellXXFormed}{
\ottdefnWFXXCapXX{}\ottdefnWFXXTypeXX{}}

% defns Values
%% defn Value_
\newcommand{\ottdruleValXXPrim}[1]{\ottdrule[#1]{%
}{
\ottkw{value} \, \ottsym{(}  \ottnt{p}  \ottsym{)}}{%
{\ottdrulename{Val\_Prim}}{}%
}}


\newcommand{\ottdruleValXXUnitXXIntro}[1]{\ottdrule[#1]{%
}{
\ottkw{value} \, \ottsym{(}  \ottsym{(}  \ottsym{)}  \ottsym{)}}{%
{\ottdrulename{Val\_Unit\_Intro}}{}%
}}


\newcommand{\ottdruleValXXBoolXXTrue}[1]{\ottdrule[#1]{%
}{
\ottkw{value} \, \ottsym{(}  \ottkw{true}  \ottsym{)}}{%
{\ottdrulename{Val\_Bool\_True}}{}%
}}


\newcommand{\ottdruleValXXBoolXXFalse}[1]{\ottdrule[#1]{%
}{
\ottkw{value} \, \ottsym{(}  \ottkw{false}  \ottsym{)}}{%
{\ottdrulename{Val\_Bool\_False}}{}%
}}


\newcommand{\ottdruleValXXIntXXIntro}[1]{\ottdrule[#1]{%
}{
\ottkw{value} \, \ottsym{(}  \mathit{k}  \ottsym{)}}{%
{\ottdrulename{Val\_Int\_Intro}}{}%
}}


\newcommand{\ottdruleValXXEltXXIntro}[1]{\ottdrule[#1]{%
}{
\ottkw{value} \, \ottsym{(}  \mathit{el}  \ottsym{)}}{%
{\ottdrulename{Val\_Elt\_Intro}}{}%
}}


\newcommand{\ottdruleValXXVar}[1]{\ottdrule[#1]{%
}{
\ottkw{value} \, \ottsym{(}  \mathit{x}  \ottsym{)}}{%
{\ottdrulename{Val\_Var}}{}%
}}


\newcommand{\ottdruleValXXFix}[1]{\ottdrule[#1]{%
}{
\ottkw{value} \, \ottsym{(}  \ottkw{fix} \, \ottsym{(}  \mathit{g}  \ottsym{,}  \mathit{x}  \ottsym{:}  \ottnt{t}  \ottsym{,}  \ottnt{e}  \ottsym{:}  \ottnt{t'}  \ottsym{)}  \ottsym{)}}{%
{\ottdrulename{Val\_Fix}}{}%
}}


\newcommand{\ottdruleValXXLambda}[1]{\ottdrule[#1]{%
}{
\ottkw{value} \, \ottsym{(}  \ottkw{fun} \, \mathit{x}  \ottsym{:}  \ottnt{t}  \rightarrow  \ottnt{e}  \ottsym{)}}{%
{\ottdrulename{Val\_Lambda}}{}%
}}


\newcommand{\ottdruleValXXGen}[1]{\ottdrule[#1]{%
\ottpremise{\ottkw{value} \, \ottsym{(}  \ottnt{e}  \ottsym{)}}%
}{
\ottkw{value} \, \ottsym{(}  \ottkw{fun} \, \mathit{fc}  \rightarrow  \ottnt{e}  \ottsym{)}}{%
{\ottdrulename{Val\_Gen}}{}%
}}


\newcommand{\ottdruleValXXSpc}[1]{\ottdrule[#1]{%
\ottpremise{\ottkw{value} \, \ottsym{(}  \ottnt{e}  \ottsym{)}}%
}{
\ottkw{value} \, \ottsym{(}  \ottnt{e}  \ottsym{[}  \mathit{fc}  \ottsym{]}  \ottsym{)}}{%
{\ottdrulename{Val\_Spc}}{}%
}}


\newcommand{\ottdruleValXXBangXXIntro}[1]{\ottdrule[#1]{%
\ottpremise{\ottkw{value} \, \ottsym{(}  \ottnt{e}  \ottsym{)}}%
}{
\ottkw{value} \, \ottsym{(}  \ottkw{many} \, \ottnt{e}  \ottsym{)}}{%
{\ottdrulename{Val\_Bang\_Intro}}{}%
}}


\newcommand{\ottdruleValXXPairXXIntro}[1]{\ottdrule[#1]{%
\ottpremise{\ottkw{value} \, \ottsym{(}  \ottnt{e_{{\mathrm{1}}}}  \ottsym{)}}%
\ottpremise{\ottkw{value} \, \ottsym{(}  \ottnt{e_{{\mathrm{2}}}}  \ottsym{)}}%
}{
\ottkw{value} \, \ottsym{(}  \ottsym{(}  \ottnt{e_{{\mathrm{1}}}}  \ottsym{,}  \ottnt{e_{{\mathrm{2}}}}  \ottsym{)}  \ottsym{)}}{%
{\ottdrulename{Val\_Pair\_Intro}}{}%
}}

\newcommand{\ottdefnValXXValueXX}[1]{\begin{ottdefnblock}[#1]{$\ottkw{value} \, \ottsym{(}  \ottnt{e}  \ottsym{)}$}{\ottcom{Value restriction for !-introduction}}
\ottusedrule{\ottdruleValXXPrim{}}
\ottusedrule{\ottdruleValXXUnitXXIntro{}}
\ottusedrule{\ottdruleValXXBoolXXTrue{}}
\ottusedrule{\ottdruleValXXBoolXXFalse{}}
\ottusedrule{\ottdruleValXXIntXXIntro{}}
\ottusedrule{\ottdruleValXXEltXXIntro{}}
\ottusedrule{\ottdruleValXXVar{}}
\ottusedrule{\ottdruleValXXFix{}}
\ottusedrule{\ottdruleValXXLambda{}}
\ottusedrule{\ottdruleValXXGen{}}
\ottusedrule{\ottdruleValXXSpc{}}
\ottusedrule{\ottdruleValXXBangXXIntro{}}
\ottusedrule{\ottdruleValXXPairXXIntro{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsValues}{
\ottdefnValXXValueXX{}}

% defns Types
%% defn Type_
\newcommand{\ottdruleTyXXVarXXLin}[1]{\ottdrule[#1]{%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}   \cdot   \ottsym{,}  \mathit{x}  \ottsym{:}  \ottnt{t}  \vdash  \mathit{x}  \ottsym{:}  \ottnt{t}}{%
{\ottdrulename{Ty\_Var\_Lin}}{}%
}}


\newcommand{\ottdruleTyXXVar}[1]{\ottdrule[#1]{%
\ottpremise{\mathit{x}  \ottsym{:}  \ottnt{t} \, \in \, \Delta}%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}   \cdot   \vdash  \mathit{x}  \ottsym{:}  \ottnt{t}}{%
{\ottdrulename{Ty\_Var}}{}%
}}


\newcommand{\ottdruleTyXXUnitXXIntro}[1]{\ottdrule[#1]{%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}   \cdot   \vdash  \ottsym{(}  \ottsym{)}  \ottsym{:}  \: !  \ottkw{unit}}{%
{\ottdrulename{Ty\_Unit\_Intro}}{}%
}}


\newcommand{\ottdruleTyXXBoolXXTrue}[1]{\ottdrule[#1]{%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}   \cdot   \vdash  \ottkw{true}  \ottsym{:}  \: !  \ottkw{bool}}{%
{\ottdrulename{Ty\_Bool\_True}}{}%
}}


\newcommand{\ottdruleTyXXBoolXXFalse}[1]{\ottdrule[#1]{%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}   \cdot   \vdash  \ottkw{false}  \ottsym{:}  \: !  \ottkw{bool}}{%
{\ottdrulename{Ty\_Bool\_False}}{}%
}}


\newcommand{\ottdruleTyXXBoolXXElim}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottkw{bool}}%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma'  \vdash  \ottnt{e_{{\mathrm{1}}}}  \ottsym{:}  \ottnt{t'}}%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma'  \vdash  \ottnt{e_{{\mathrm{2}}}}  \ottsym{:}  \ottnt{t'}}%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \ottsym{,}  \Gamma'  \vdash  \ottkw{if} \, \ottnt{e} \, \ottkw{then} \, \ottnt{e_{{\mathrm{1}}}} \, \ottkw{else} \, \ottnt{e_{{\mathrm{2}}}}  \ottsym{:}  \ottnt{t}}{%
{\ottdrulename{Ty\_Bool\_Elim}}{}%
}}


\newcommand{\ottdruleTyXXIntXXIntro}[1]{\ottdrule[#1]{%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}   \cdot   \vdash  \mathit{k}  \ottsym{:}  \: !  \ottkw{int}}{%
{\ottdrulename{Ty\_Int\_Intro}}{}%
}}


\newcommand{\ottdruleTyXXEltXXIntro}[1]{\ottdrule[#1]{%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}   \cdot   \vdash  \mathit{el}  \ottsym{:}  \: !  \ottkw{elt}}{%
{\ottdrulename{Ty\_Elt\_Intro}}{}%
}}


\newcommand{\ottdruleTyXXBangXXIntro}[1]{\ottdrule[#1]{%
\ottpremise{\ottkw{value} \, \ottsym{(}  \ottnt{e}  \ottsym{)}}%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{;}   \cdot   \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}}%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}   \cdot   \vdash  \ottkw{many} \, \ottnt{e}  \ottsym{:}  \: !  \ottnt{t}}{%
{\ottdrulename{Ty\_Bang\_Intro}}{}%
}}


\newcommand{\ottdruleTyXXBangXXElim}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \vdash  \ottnt{e}  \ottsym{:}  \: !  \ottnt{t}}%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{,}  \mathit{x}  \ottsym{:}  \ottnt{t}  \ottsym{;}  \Gamma'  \vdash  \ottnt{e'}  \ottsym{:}  \ottnt{t'}}%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \ottsym{,}  \Gamma'  \vdash  \ottkw{let} \, \ottkw{many} \, \mathit{x}  \ottsym{=}  \ottnt{e} \, \ottkw{in} \, \ottnt{e'}  \ottsym{:}  \ottnt{t'}}{%
{\ottdrulename{Ty\_Bang\_Elim}}{}%
}}


\newcommand{\ottdruleTyXXPairXXIntro}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}}%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma'  \vdash  \ottnt{e'}  \ottsym{:}  \ottnt{t'}}%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \ottsym{,}  \Gamma'  \vdash  \ottsym{(}  \ottnt{e}  \ottsym{,}  \ottnt{e'}  \ottsym{)}  \ottsym{:}  \ottnt{t}  \otimes  \ottnt{t'}}{%
{\ottdrulename{Ty\_Pair\_Intro}}{}%
}}


\newcommand{\ottdruleTyXXPairXXElim}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \vdash  \ottnt{e_{{\mathrm{12}}}}  \ottsym{:}  \ottnt{t_{{\mathrm{1}}}}  \otimes  \ottnt{t_{{\mathrm{2}}}}}%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma'  \ottsym{,}  \mathit{a}  \ottsym{:}  \ottnt{t_{{\mathrm{1}}}}  \ottsym{,}  \mathit{b}  \ottsym{:}  \ottnt{t_{{\mathrm{2}}}}  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}}%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \ottsym{,}  \Gamma'  \vdash  \ottkw{let} \, \ottsym{(}  \mathit{a}  \ottsym{,}  \mathit{b}  \ottsym{)}  \ottsym{=}  \ottnt{e_{{\mathrm{12}}}} \, \ottkw{in} \, \ottnt{e}  \ottsym{:}  \ottnt{t}}{%
{\ottdrulename{Ty\_Pair\_Elim}}{}%
}}


\newcommand{\ottdruleTyXXLambda}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \vdash  \ottnt{t'} \, \textsf{Type}}%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \ottsym{,}  \mathit{x}  \ottsym{:}  \ottnt{t'}  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}}%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \vdash  \ottkw{fun} \, \mathit{x}  \ottsym{:}  \ottnt{t'}  \rightarrow  \ottnt{e}  \ottsym{:}  \ottnt{t'}  \multimap  \ottnt{t}}{%
{\ottdrulename{Ty\_Lambda}}{}%
}}


\newcommand{\ottdruleTyXXApp}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t'}  \multimap  \ottnt{t}}%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma'  \vdash  \ottnt{e'}  \ottsym{:}  \ottnt{t'}}%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \ottsym{,}  \Gamma'  \vdash  \ottnt{e} \, \ottnt{e'}  \ottsym{:}  \ottnt{t}}{%
{\ottdrulename{Ty\_App}}{}%
}}


\newcommand{\ottdruleTyXXGen}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \ottsym{,}  \mathit{fc}  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}}%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \vdash  \ottkw{fun} \, \mathit{fc}  \rightarrow  \ottnt{e}  \ottsym{:}  \forall \, \mathit{fc}  \ottsym{.}  \ottnt{t}}{%
{\ottdrulename{Ty\_Gen}}{}%
}}


\newcommand{\ottdruleTyXXSpc}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \vdash  \ottnt{f} \, \textsf{Cap}}%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \vdash  \ottnt{e}  \ottsym{:}  \forall \, \mathit{fc}  \ottsym{.}  \ottnt{t}}%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \vdash  \ottnt{e}  \ottsym{[}  \ottnt{f}  \ottsym{]}  \ottsym{:}  \ottnt{t}  \ottsym{\{}  \ottnt{f}  \ottsym{/}  \mathit{fc}  \ottsym{\}}}{%
{\ottdrulename{Ty\_Spc}}{}%
}}


\newcommand{\ottdruleTyXXFix}[1]{\ottdrule[#1]{%
\ottpremise{\Theta  \ottsym{;}  \Delta  \ottsym{,}  \mathit{g}  \ottsym{:}  \ottnt{t}  \multimap  \ottnt{t'}  \ottsym{;}   \cdot   \ottsym{,}  \mathit{x}  \ottsym{:}  \ottnt{t}  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t'}}%
}{
\Theta  \ottsym{;}  \Delta  \ottsym{;}   \cdot   \vdash  \ottkw{fix} \, \ottsym{(}  \mathit{g}  \ottsym{,}  \mathit{x}  \ottsym{:}  \ottnt{t}  \ottsym{,}  \ottnt{e}  \ottsym{:}  \ottnt{t'}  \ottsym{)}  \ottsym{:}  \: !  \ottsym{(}  \ottnt{t}  \multimap  \ottnt{t'}  \ottsym{)}}{%
{\ottdrulename{Ty\_Fix}}{}%
}}

\newcommand{\ottdefnTyXXTypeXX}[1]{\begin{ottdefnblock}[#1]{$\Theta  \ottsym{;}  \Delta  \ottsym{;}  \Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}$}{\ottcom{Typing rules for expressions (no primitives yet)}}
\ottusedrule{\ottdruleTyXXVarXXLin{}}
\ottusedrule{\ottdruleTyXXVar{}}
\ottusedrule{\ottdruleTyXXUnitXXIntro{}}
\ottusedrule{\ottdruleTyXXBoolXXTrue{}}
\ottusedrule{\ottdruleTyXXBoolXXFalse{}}
\ottusedrule{\ottdruleTyXXBoolXXElim{}}
\ottusedrule{\ottdruleTyXXIntXXIntro{}}
\ottusedrule{\ottdruleTyXXEltXXIntro{}}
\ottusedrule{\ottdruleTyXXBangXXIntro{}}
\ottusedrule{\ottdruleTyXXBangXXElim{}}
\ottusedrule{\ottdruleTyXXPairXXIntro{}}
\ottusedrule{\ottdruleTyXXPairXXElim{}}
\ottusedrule{\ottdruleTyXXLambda{}}
\ottusedrule{\ottdruleTyXXApp{}}
\ottusedrule{\ottdruleTyXXGen{}}
\ottusedrule{\ottdruleTyXXSpc{}}
\ottusedrule{\ottdruleTyXXFix{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsTypes}{
\ottdefnTyXXTypeXX{}}

\newcommand{\ottdefnss}{
\ottdefnsWellXXFormed
\ottdefnsValues
\ottdefnsTypes
}

\newcommand{\ottall}{\ottmetavars\\[0pt]
\ottgrammar\\[5.0mm]
\ottdefnss}

