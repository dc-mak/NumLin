let rec f (!i : !int) (!n : !int) (!x0 : !elt) ('x) (row : 'x arr) : !elt * 'x arr =
    if i = n then
        (x0, row)
    else
        let (row, x1) = row[i] in
        f (i + 1) n (x0 +. x1) 'x row in
    f
;;
